---
phase: 01-secure-foundation
plan: 08
type: execute
wave: 1
depends_on: []
files_modified:
  - src/cli/commands/generate.ts
  - src/lib/clawdbot.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "CLI defaults to non-interactive mode (no prompts)"
    - "User can provide description via --description flag for bot automation"
    - "User can auto-confirm upload via --yes/-y flag for CI/CD pipelines"
    - "Examples show bot-friendly usage patterns"
  artifacts:
    - path: "src/cli/commands/generate.ts"
      provides: "CLI flags and command logic"
      exports: ["--interactive", "--description", "--yes"]
    - path: "src/lib/clawdbot.ts"
      provides: "Fallback description for non-interactive mode"
      contains: "userDescription || 'A helpful AI assistant'"
  key_links:
    - from: "src/cli/commands/generate.ts"
      to: "src/lib/clawdbot.ts"
      via: "extractPublicConfig(userDescription)"
      pattern: "extractPublicConfig.*description"
---

<objective>
Fix Gap 3: Interactive Mode UX - Make CLI bot-friendly and CI/CD-ready by defaulting to non-interactive mode and adding flags for description and auto-confirmation.

Purpose: The current CLI defaults to interactive mode which blocks automation. This gap closure makes the CLI suitable for bot-driven workflows and CI/CD pipelines.
Output: Updated CLI with --interactive=false default, --description flag, --yes/-y flag, and bot-friendly examples.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Gap 3 Details:**
- **Truth**: CLI prompts user for bot description ("yearbook quote") interactively and includes it in the generated profile
- **Status**: Failed (minor severity)
- **Root cause**: --interactive defaults to true, no --description flag exists, UX designed for humans first not bot automation
- **Missing fixes**:
  1. Change --interactive default from true to false
  2. Add --description flag for non-interactive description input
  3. Add --yes / -y flag for auto-confirm upload
  4. Update examples for bot-friendly usage

**Files to modify:**
- src/cli/commands/generate.ts:22 (interactive flag default)
- src/cli/commands/generate.ts:85-94 (add --description flag, modify inquirer logic)
- src/lib/clawdbot.ts:116 (fallback description when non-interactive)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Change --interactive default to false</name>
  <files>src/cli/commands/generate.ts</files>
  <action>
    Change the --interactive flag default from `true` to `false` on line 22.
    
    Current:
    ```typescript
    interactive: Flags.boolean({
      description: 'Run with interactive prompts for bot configuration',
      default: true,
    }),
    ```
    
    Change to:
    ```typescript
    interactive: Flags.boolean({
      description: 'Run with interactive prompts for bot configuration',
      default: false,
    }),
    ```
    
    This makes the CLI bot-friendly by default, requiring explicit --interactive flag for human prompts.
  </action>
  <verify>grep -n "default: false" src/cli/commands/generate.ts | head -1</verify>
  <done>--interactive flag defaults to false, CLI runs non-interactively by default</done>
</task>

<task type="auto">
  <name>Task 2: Add --description and --yes/-y flags</name>
  <files>src/cli/commands/generate.ts</files>
  <action>
    Add two new flags to the static flags object:
    
    1. Add --description flag (string) after the --path flag:
    ```typescript
    description: Flags.string({
      char: 'd',
      description: 'Bot description for the profile (yearbook quote style)',
    }),
    ```
    
    2. Add --yes/-y flag (boolean) after --description:
    ```typescript
    yes: Flags.boolean({
      char: 'y',
      description: 'Auto-confirm upload without prompting',
      default: false,
    }),
    ```
    
    3. Modify the description logic (lines 84-94) to use the flag:
    ```typescript
    // Step 3: Get description from flag or interactively
    let userDescription = flags.description || '';
    if (flags.interactive && !userDescription) {
      const answers = await inquirer.prompt([{
        type: 'input',
        name: 'description',
        message: 'Describe your bot (yearbook quote style):',
        default: 'A helpful AI assistant',
        validate: (input: string) => input.length > 0 && input.length <= 500 || 'Description must be 1-500 characters'
      }]);
      userDescription = answers.description;
    }
    ```
    
    4. Modify the upload confirmation logic (lines 167-179) to respect --yes flag:
    ```typescript
    // Ask for confirmation if interactive and not auto-confirmed
    let shouldUpload = true;
    if (flags.interactive && !flags.yes) {
      const { confirm } = await inquirer.prompt([
        {
          type: 'confirm',
          name: 'confirm',
          message: 'Upload this profile to BotArena?',
          default: true
        }
      ]);
      shouldUpload = confirm;
    }
    ```
  </action>
  <verify>
    grep -n "description: Flags.string" src/cli/commands/generate.ts && \
    grep -n "yes: Flags.boolean" src/cli/commands/generate.ts && \
    grep -n "flags.description" src/cli/commands/generate.ts
  </verify>
  <done>--description and --yes/-y flags added and integrated into the flow</done>
</task>

<task type="auto">
  <name>Task 3: Update examples for bot-friendly usage</name>
  <files>src/cli/commands/generate.ts</files>
  <action>
    Update the static examples array (lines 13-17) to show bot-friendly usage patterns:
    
    Current:
    ```typescript
    static examples = [
      '<%= config.bin %> <%= command.id %>',
      '<%= config.bin %> <%= command.id %> --interactive',
      '<%= config.bin %> <%= command.id %> --dry-run',
    ];
    ```
    
    Change to:
    ```typescript
    static examples = [
      // Bot-friendly (non-interactive) examples
      '<%= config.bin %> <%= command.id %> --description "My awesome bot"',
      '<%= config.bin %> <%= command.id %> --description "My bot" --yes',
      '<%= config.bin %> <%= command.id %> --description "My bot" --dry-run',
      // Interactive examples for humans
      '<%= config.bin %> <%= command.id %> --interactive',
      '<%= config.bin %> <%= command.id %> --interactive --dry-run',
    ];
    ```
    
    This prioritizes bot-friendly examples first, making it clear how to use the CLI in automation.
  </action>
  <verify>grep -A 10 "static examples" src/cli/commands/generate.ts | grep "description"</verify>
  <done>Examples updated to show bot-friendly usage patterns first</done>
</task>

<task type="auto">
  <name>Task 4: Adjust non-interactive flow messaging</name>
  <files>src/cli/commands/generate.ts</files>
  <action>
    Add a helpful message when running in non-interactive mode without a description, informing the user about the --description flag.
    
    After the description logic (around line 94), add:
    ```typescript
    // Inform user about non-interactive mode
    if (!flags.interactive && !userDescription) {
      this.log('ℹ️  Running in non-interactive mode. Use --description to set a custom description.');
    }
    ```
    
    Also update the description flag help text to mention the default fallback:
    ```typescript
    description: Flags.string({
      char: 'd',
      description: 'Bot description for the profile (yearbook quote style). Defaults to "A helpful AI assistant" if not provided.',
    }),
    ```
    
    This ensures users understand the behavior when running without --interactive.
  </action>
  <verify>grep -n "non-interactive mode" src/cli/commands/generate.ts</verify>
  <done>Non-interactive mode shows helpful message about --description flag</done>
</task>

</tasks>

<verification>
**Gap 3 Closure Verification:**

1. **Default behavior**: Run `botarena generate --help` and verify `--interactive` defaults to false
2. **Description flag**: Run `botarena generate --description "Test bot" --dry-run` and verify description is used
3. **Yes flag**: Run `botarena generate --description "Test" --yes` and verify no confirmation prompt (in a test environment)
4. **Examples**: Run `botarena generate --help` and verify examples show bot-friendly usage first
5. **Non-interactive message**: Run `botarena generate --dry-run` without --description and verify the info message appears
</verification>

<success_criteria>
- [ ] --interactive flag defaults to false
- [ ] --description/-d flag accepts description string
- [ ] --yes/-y flag auto-confirms upload without prompt
- [ ] Examples show bot-friendly usage patterns first
- [ ] Non-interactive mode shows helpful message about --description
- [ ] All existing tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/01-secure-foundation/01-08-SUMMARY.md`
</output>
