---
phase: 01-secure-foundation
plan: 05
type: execute
wave: 3
depends_on: ["01-02", "01-04"]
files_modified: ["src/cli/commands/generate.ts", "src/cli/commands/upload.ts", "src/app/bots/[slug]/page.tsx", "src/components/ProfileView.tsx"]
autonomous: true
user_setup: []

must_haves:
  truths:
    - "CLI can upload extracted bot configuration to Convex"
    - "User receives public profile URL after successful upload"
    - "Bot profile pages display complete configuration information"
    - "Self-description (yearbook quote) is prominently displayed"
    - "Public URLs are shareable and accessible without authentication"
  artifacts:
    - path: "src/cli/commands/upload.ts"
      provides: "CLI command for uploading profiles to Convex"
      min_lines: 40
    - path: "src/cli/commands/generate.ts"
      provides: "Updated generate command with upload functionality"
      contains: "upload integration"
    - path: "src/app/bots/[slug]/page.tsx"
      provides: "Dynamic route for individual bot profile pages"
      min_lines: 30
    - path: "src/components/ProfileView.tsx"
      provides: "Component for detailed bot profile display"
      min_lines: 50
  key_links:
    - from: "src/cli/commands/upload.ts"
      to: "src/app/api/profiles/route.ts"
      via: "HTTP POST request to create profile"
      pattern: "fetch.*api/profiles"
    - from: "src/app/bots/[slug]/page.tsx"
      to: "src/app/api/profiles/route.ts"
      via: "API data fetching for profile display"
      pattern: "fetch.*api/profiles"
    - from: "src/app/bots/[slug]/page.tsx"
      to: "src/components/ProfileView.tsx"
      via: "Profile view component usage"
      pattern: "import.*ProfileView"
---

<objective>
Complete end-to-end profile generation and display with CLI upload functionality and public profile pages.

Purpose: Integrate CLI extraction with web platform by implementing profile upload to Convex and creating dynamic profile pages for public sharing and viewing.
Output: Complete workflow where users can run `npx botarena generate` to create and upload profiles, then view and share them on botarena.sh.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/REQUIREMENTS.md
@.planning/ROADMAP.md
@.planning/phases/01-secure-foundation/01-DISCOVERY.md
@.planning/phases/01-secure-foundation/01-02-SUMMARY.md
@.planning/phases/01-secure-foundation/01-04-SUMMARY.md
@.planning/research/STACK.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CLI upload command for profile submission</name>
  <files>src/cli/commands/upload.ts, src/cli/commands/generate.ts</files>
  <action>
  1. Create src/cli/commands/upload.ts:
  
  ```typescript
  import { Command, Flags } from '@oclif/core';
  import { PublicBotConfig } from '../../schemas/bot-config';

  export default class Upload extends Command {
    static description = 'Upload bot profile to BotArena platform';
    
    static flags = {
      config: Flags.string({
        char: 'c',
        description: 'Path to bot configuration file',
        required: false
      }),
      url: Flags.string({
        char: 'u',
        description: 'BotArena API URL',
        default: 'https://botarena.sh'
      })
    };

    async run(): Promise<void> {
      const { flags } = this;
      
      try {
        // Load configuration (from file or stdin)
        let config: PublicBotConfig;
        
        if (flags.config) {
          // Load from file
          const fs = await import('fs/promises');
          const fileContent = await fs.readFile(flags.config, 'utf-8');
          config = JSON.parse(fileContent);
        } else {
          // Read from stdin
          const { createInterface } = await import('readline');
          const lines: string[] = [];
          
          const rl = createInterface({
            input: process.stdin,
            output: process.stdout,
            terminal: false
          });
          
          for await (const line of rl) {
            lines.push(line);
          }
          
          config = JSON.parse(lines.join('\n'));
        }
        
        // Validate configuration
        const validatedConfig = PublicBotConfig.parse(config);
        this.log(`ü§ñ Uploading profile: ${validatedConfig.name}`);
        
        // Upload to BotArena
        const response = await fetch(`${flags.url}/api/profiles`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'User-Agent': 'botarena-cli/1.0.0'
          },
          body: JSON.stringify(validatedConfig)
        });
        
        const result = await response.json();
        
        if (response.ok && result.success) {
          const profileUrl = `${flags.url}/bots/${result.data.slug}`;
          
          this.log('‚úÖ Profile uploaded successfully!');
          this.log(`üìä Name: ${result.data.name}`);
          this.log(`üîó Profile URL: ${profileUrl}`);
          this.log(`üÜî Profile ID: ${result.data.id}`);
          this.log(`üìÖ Created: ${new Date(result.data.created_at).toLocaleDateString()}`);
          this.log('\nüéâ Share your bot profile with the world!');
          
        } else {
          throw new Error(result.error || 'Upload failed');
        }
        
      } catch (error) {
        if (error instanceof SyntaxError) {
          this.error('‚ùå Invalid JSON configuration format');
        } else {
          this.error(`‚ùå Upload failed: ${error.message}`);
        }
      }
    }
  }
  ```
  
  2. Update src/cli/commands/generate.ts to integrate upload:
  
  ```typescript
  // Add to the run() method after config extraction:
  
  if (!flags['dry-run']) {
    // Show configuration summary
    this.log('\nüìã Profile Summary:');
    this.log(`Name: ${publicConfig.name}`);
    this.log(`LLM: ${publicConfig.llm.primary}`);
    this.log(`Description: "${publicConfig.description}"`);
    this.log(`Skills: ${publicConfig.skills.join(', ')}`);
    
    // Ask for confirmation if interactive
    let shouldUpload = true;
    if (flags.interactive) {
      const { confirm } = await inquirer.prompt([
        {
          type: 'confirm',
          name: 'confirm',
          message: 'Upload this profile to BotArena?',
          default: true
        }
      ]);
      shouldUpload = confirm;
    }
    
    if (shouldUpload) {
      this.log('\nüöÄ Uploading to BotArena...');
      
      // Pipe config to upload command
      const { Upload } = await import('./upload');
      const uploadCmd = new Upload();
      await uploadCmd.run(['--config', '-']); // Use stdin
    }
  }
  ```
  
  3. Update package.json bin commands if needed
  
  From DISCOVERY.md: Implement complete CLI workflow with progress indicators and user-friendly feedback.
  </action>
  <verify>CLI upload command compiles and integrates with generate command correctly</verify>
  <done>CLI upload command implemented with configuration validation and user-friendly feedback</done>
</task>

<task type="auto">
  <name>Task 2: Create dynamic bot profile pages</name>
  <files>src/app/bots/[slug]/page.tsx</files>
  <action>
  1. Create src/app/bots/[slug]/page.tsx with:
  
  ```typescript
  import { Metadata } from 'next';
  import { notFound } from 'next/navigation';
  import { getBotProfile } from '@/lib/convex';
  import { ProfileView } from '@/components/ProfileView';

  interface BotProfilePageProps {
    params: {
      slug: string;
    };
  }

  export async function generateMetadata(
    { params }: BotProfilePageProps
  ): Promise<Metadata> {
    const profile = await getBotProfile(params.slug);
    
    if (!profile) {
      return {
        title: 'Bot Not Found | BotArena',
        description: 'This bot profile could not be found.'
      };
    }
    
    return {
      title: `${profile.name} | BotArena`,
      description: profile.description,
      openGraph: {
        title: `${profile.name} - AI Bot Profile`,
        description: profile.description,
        url: `https://botarena.sh/bots/${profile.slug}`,
        type: 'profile',
        images: [
          {
            url: '/og-image.png', // TODO: Generate dynamic OG images
            width: 1200,
            height: 630,
            alt: `${profile.name} AI Bot Profile`
          }
        ]
      },
      twitter: {
        card: 'summary_large_image',
        title: `${profile.name} - AI Bot Profile`,
        description: profile.description
      }
    };
  }

  export default async function BotProfilePage({ params }: BotProfilePageProps) {
    const profile = await getBotProfile(params.slug);
    
    if (!profile) {
      notFound();
    }
    
    return (
      <div className="min-h-screen">
        <ProfileView profile={profile} />
      </div>
    );
  }

  // Generate static paths for known profiles (optional optimization)
  export async function generateStaticParams() {
    // For now, return empty to generate on-demand
    // In future, fetch from Convex to pre-generate popular profiles
    return [];
  }
  ```
  
  2. Add proper error handling with 404 pages
  3. Include SEO metadata for social sharing
  4. Implement static generation considerations
  
  From REQUIREMENTS.md: Provide public profile URLs for sharing bot configurations (PROF-02).
  </action>
  <verify>Dynamic route compiles and handles slug parameters correctly</verify>
  <done>Dynamic bot profile pages created with SEO optimization and proper error handling</done>
</task>

<task type="auto">
  <name>Task 3: Create detailed profile view component</name>
  <files>src/components/ProfileView.tsx</files>
  <action>
  1. Create src/components/ProfileView.tsx:
  
  ```typescript
  'use client';

  import { BotProfile } from '@/lib/convex';
  { motion } from 'motion/react';

  interface ProfileViewProps {
    profile: BotProfile;
  }

  export function ProfileView({ profile }: ProfileViewProps) {
    const config = profile.config; // PublicBotConfig data
    
    return (
      <div className="container mx-auto px-4 py-8">
        {/* Profile Header */}
        <motion.div 
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          className="text-center mb-12"
        >
          {/* Bot Avatar/Icon */}
          <div className="w-24 h-24 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full mx-auto mb-6 flex items-center justify-center">
            <span className="text-4xl">ü§ñ</span>
          </div>
          
          {/* Bot Name and Self-Description */}
          <h1 className="text-4xl md:text-5xl font-bold text-white mb-4">
            {profile.name}
          </h1>
          
          <div className="max-w-2xl mx-auto mb-6">
            <p className="text-xl text-purple-200 italic">
              "{profile.description}"
            </p>
            <p className="text-sm text-purple-300 mt-2">
              ‚Äî {profile.name}'s yearbook quote
            </p>
          </div>
          
          {/* Share Buttons */}
          <div className="flex justify-center gap-4">
            <button
              onClick={() => navigator.share({ 
                title: `${profile.name} - AI Bot Profile`,
                url: window.location.href,
                text: profile.description
              })}
              className="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
            >
              Share Profile
            </button>
            <button
              onClick={() => navigator.clipboard.writeText(window.location.href)}
              className="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
            >
              Copy Link
            </button>
          </div>
        </motion.div>

        {/* Configuration Details */}
        <div className="grid md:grid-cols-2 gap-8 max-w-6xl mx-auto">
          {/* Core Configuration */}
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.1 }}
            className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-purple-500/20"
          >
            <h2 className="text-2xl font-bold text-white mb-4">‚öôÔ∏è Core Configuration</h2>
            
            <div className="space-y-4">
              <div>
                <div className="text-sm text-purple-300 uppercase">Primary LLM</div>
                <div className="text-lg font-semibold text-white">{config.llm.primary}</div>
              </div>
              
              {config.llm.fallbacks && config.llm.fallbacks.length > 0 && (
                <div>
                  <div className="text-sm text-purple-300 uppercase">Fallback LLMs</div>
                  <div className="flex flex-wrap gap-2 mt-1">
                    {config.llm.fallbacks.map((llm: string, index: number) => (
                      <span key={index} className="px-3 py-1 bg-blue-500/20 text-blue-200 rounded-full text-sm">
                        {llm}
                      </span>
                    ))}
                  </div>
                </div>
              )}
              
              <div>
                <div className="text-sm text-purple-300 uppercase">Runtime Harness</div>
                <div className="text-lg font-semibold text-white">{config.harness}</div>
              </div>
              
              <div>
                <div className="text-sm text-purple-300 uppercase">Version</div>
                <div className="text-lg font-semibold text-white">{config.version}</div>
              </div>
            </div>
          </motion.div>

          {/* Capabilities */}
          <motion.div
            initial={{ opacity: 0, x: 20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.2 }}
            className="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-purple-500/20"
          >
            <h2 className="text-2xl font-bold text-white mb-4">üöÄ Capabilities</h2>
            
            <div className="space-y-6">
              {/* Skills */}
              {config.skills && config.skills.length > 0 && (
                <div>
                  <div className="text-sm text-purple-300 uppercase mb-2">Skills</div>
                  <div className="flex flex-wrap gap-2">
                    {config.skills.map((skill: string, index: number) => (
                      <span key={index} className="px-3 py-1 bg-green-500/20 text-green-200 rounded-full text-sm">
                        {skill}
                      </span>
                    ))}
                  </div>
                </div>
              )}
              
              {/* MCPs */}
              {config.mcps && config.mcps.length > 0 && (
                <div>
                  <div className="text-sm text-purple-300 uppercase mb-2">Model Context Protocols</div>
                  <div className="flex flex-wrap gap-2">
                    {config.mcps.map((mcp: string, index: number) => (
                      <span key={index} className="px-3 py-1 bg-purple-500/20 text-purple-200 rounded-full text-sm">
                        {mcp}
                      </span>
                    ))}
                  </div>
                </div>
              )}
              
              {/* CLIs */}
              {config.clis && config.clis.length > 0 && (
                <div>
                  <div className="text-sm text-purple-300 uppercase mb-2">Command Line Tools</div>
                  <div className="flex flex-wrap gap-2">
                    {config.clis.map((cli: string, index: number) => (
                      <span key={index} className="px-3 py-1 bg-yellow-500/20 text-yellow-200 rounded-full text-sm">
                        {cli}
                      </span>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </motion.div>
        </div>

        {/* Footer */}
        <div className="text-center mt-16">
          <p className="text-purple-300">
            Profile created on {new Date(profile.created_at).toLocaleDateString()}
          </p>
          <p className="text-sm text-purple-400 mt-2">
            Generated with <span className="text-white font-semibold">npx botarena</span>
          </p>
        </div>
      </div>
    );
  }
  ```
  
  2. Add Motion animations for smooth transitions
  3. Include share functionality and copy-to-clipboard
  4. Implement responsive design for mobile and desktop
  
  From PROJECT.md: Create beautiful, comparable format with gaming-inspired visuals and emotional attachment.
  </action>
  <verify>Profile view component displays all bot information correctly with animations</verify>
  <done>Detailed profile view component created with gaming-inspired design and sharing functionality</done>
</task>

</tasks>

<verification>
- CLI upload command successfully creates profiles in Convex
- Profile pages render correctly with slug-based routing
- Profile display shows all configuration data beautifully
- Share functionality works for social media and link copying
- Self-description (yearbook quote) is prominently displayed
- Public URLs are accessible without authentication
</verification>

<success_criteria>
- User can run `npx botarena generate` and successfully upload a profile
- User receives a shareable public URL after successful upload
- Bot profile pages display complete configuration including self-description
- Profile URLs are accessible and shareable without authentication
- Gaming-inspired visual design creates emotional attachment
- All Phase 1 requirements are successfully implemented
</success_criteria>

<output>
After completion, create `.planning/phases/01-secure-foundation/01-05-SUMMARY.md`
</output>